# Export: 2.2 — Current State Recap (Section 2)

Source: ../2%202-%20%F0%9F%97%BF%20Current%20State%20Recap%20(Section%202)%2029d608c2eef780ba9491c5d81f102496.md

Summary (key points):
- Environment: three portal layouts (client/engineer/enterprise), `profiles.role` still present; partial AI; Stripe not integrated; FeatureGate underused
- Technical Debt: layout duplication, role-based logic, role='admin' in RLS, scattered AI tools, missing gating tests, no webhook handling, outdated docs
- Legacy Architecture: multi-portal frontend; backend RLS tied to role; limited tests and payments; outdated documentation
- Key Observations: ~42 role refs; 6 RLS policies use role='admin'; Stripe env missing; toolbar commented out
- Validation Status: Auth 100%, Dashboard 70%, Payments 0%, AI Tools 50%, DB/RLS 60%, E2E partial
- Audit Commands: ripgrep scans for roles/stripe; run tests; playwright e2e
- Transition Plan: merge layouts → AppLayout; migrate `profiles.role` → `subscription_tier` + `is_admin`; rebuild RLS; centralize tool registry
- Checklist: code audit, policies inventory, layout inventory, test gaps, tool registry, env keys, current state doc

Navigation:
- For full details, open the source link above.
- See ../../README.md for the ordered section list.
